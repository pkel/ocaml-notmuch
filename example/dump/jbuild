(executables
 ((libraries (notmuch core))
  (names (dump))
  (preprocess (pps (ppx_jane ppx_driver.runner)))
  (modules (dump))))

(rule
  (with-stdout-to data.should (run notmuch dump --include=tags)))

(rule
  (with-stdout-to data.is (run ./dump.exe)))

(alias
 ((name runtest)
  (package notmuch)
  (action (diff data.should data.is))))
